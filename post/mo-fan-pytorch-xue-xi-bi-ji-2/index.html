<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>莫烦pytorch学习笔记2 | lonelyisland&#39;s blog</title>
<link rel="shortcut icon" href="https://lonely-island.github.io/favicon.ico?v=1610592775860">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://lonely-island.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="莫烦pytorch学习笔记2 | lonelyisland&#39;s blog - Atom Feed" href="https://lonely-island.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="pytorch
类似numpy，pytorch就是在神经网络领域代替numpy的模块
神经网络在做什么？

线性拟合
分类

安装
pytorch类似tensorflow使用tensor表示高维信息
参考pytorch环境搭建
或者看pyt..." />
    <meta name="keywords" content="pytorch" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://lonely-island.github.io">
  <img class="avatar" src="https://lonely-island.github.io/images/avatar.png?v=1610592775860" alt="">
  </a>
  <h1 class="site-title">
    lonelyisland&#39;s blog
  </h1>
  <p class="site-description">
    好好学习，认真生活
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/lonely-island" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              莫烦pytorch学习笔记2
            </h2>
            <div class="post-info">
              <span>
                2020-06-09
              </span>
              <span>
                3 min read
              </span>
              
                <a href="https://lonely-island.github.io/tag/8WvW9dPu9/" class="post-tag">
                  # pytorch
                </a>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h2 id="pytorch">pytorch</h2>
<p>类似numpy，pytorch就是在神经网络领域代替numpy的模块</p>
<p><strong>神经网络在做什么？</strong></p>
<ul>
<li>线性拟合</li>
<li>分类</li>
</ul>
<h2 id="安装">安装</h2>
<p>pytorch类似tensorflow使用tensor表示高维信息</p>
<p>参考<a href="https://www.cnblogs.com/lonelyisland/p/12809422.html">pytorch环境搭建</a></p>
<p>或者看pytorch官方文档</p>
<p>官网命令安装了两个东西</p>
<ul>
<li>torch</li>
<li>torchvision:有一些数据库以及预训练好的网络，可以直接下载到本地的直接用--transform learning)</li>
</ul>
<h2 id="对比numpy和pytorch">对比numpy和pytorch</h2>
<p>可以进行一些矩阵相关的运算</p>
<p><a href="https://morvanzhou.github.io/tutorials/machine-learning/torch/2-01-torch-numpy/">莫烦</a></p>
<p>另外参考pytorch官方网站文档</p>
<h2 id="variable变量">variable变量</h2>
<p><a href="https://morvanzhou.github.io/tutorials/machine-learning/torch/2-02-variable/">莫烦</a></p>
<h2 id="为什么需要激励函数">为什么需要激励函数？</h2>
<ul>
<li>
<p>线性方程</p>
<p>y = Wx</p>
</li>
<li>
<p>非线性方程</p>
<p>y = AF(Wx) ---掰弯了233</p>
</li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://raw.githubusercontent.com/lonelyislandXD/picLib/master/img/20200608163101.png" alt="image-20200608163055519" loading="lazy"></figure>
<p>激励函数必须使可微分的，在反向传播back propagation的时候，只有可微分的才可以把误差传递回去</p>
<figure data-type="image" tabindex="2"><img src="https://raw.githubusercontent.com/lonelyislandXD/picLib/master/img/20200608163251.png" alt="image-20200608163248878" loading="lazy"></figure>
<p>需要注意的是，如果隐藏层比较少，可以随便选择激活函数，在隐藏层比较多的时候，需谨慎考虑，存在<a href="%5Bhttps://www.google.com/search?q=%E6%A2%AF%E5%BA%A6%E7%88%86%E7%82%B8%E5%92%8C%E6%A2%AF%E5%BA%A6%E6%B6%88%E5%A4%B1&amp;oq=%E6%A2%AF%E5%BA%A6%E7%88%86%E7%82%B8%E5%92%8C%E6%A2%AF%E5%BA%A6%E6%B6%88%E5%A4%B1&amp;aqs=chrome..69i57.4453j0j7&amp;sourceid=chrome&amp;ie=UTF-8%5D(https://www.google.com/search?q=%E6%A2%AF%E5%BA%A6%E7%88%86%E7%82%B8%E5%92%8C%E6%A2%AF%E5%BA%A6%E6%B6%88%E5%A4%B1&amp;oq=%E6%A2%AF%E5%BA%A6%E7%88%86%E7%82%B8%E5%92%8C%E6%A2%AF%E5%BA%A6%E6%B6%88%E5%A4%B1&amp;aqs=chrome..69i57.4453j0j7&amp;sourceid=chrome&amp;ie=UTF-8)">梯度爆炸和梯度消失</a>的问题</p>
<p><strong>默认首选</strong></p>
<ul>
<li>
<p>少量隐藏层中可以尝试各种</p>
</li>
<li>
<p>CNN中推荐relu</p>
</li>
<li>
<p>RNN 推荐relu 和 tanh</p>
</li>
</ul>
<h2 id="激励函数activation-function">激励函数activation function</h2>
<p>学习资料：</p>
<ul>
<li></li>
<li>
<p>见莫烦python的介绍激励函数视频</p>
</li>
</ul>
<p>几种激活函数图像</p>
<figure data-type="image" tabindex="3"><img src="https://raw.githubusercontent.com/lonelyislandXD/picLib/master/img/20200608163813.png" alt="image-20200608163811659" loading="lazy"></figure>
<p>另外softmax是一种做出来是概率图，不是线图</p>
<p>关于图像可以看莫烦python教程关于matplotlib，numpy以及pandas的介绍</p>
<h2 id="回归关系拟合">回归（关系拟合）</h2>
<p>回归：损失函数一般使用<code>torch.nn.MSELoss()</code></p>
<pre><code class="language-python">import torch
import matplotlib.pyplot as plt

x = torch.unsqueeze(torch.linspace(-1, 1, 100), dim=1)  # x data (tensor), shape=(100, 1)
y = x.pow(2) + 0.2*torch.rand(x.size())                 # noisy y data (tensor), shape=(100, 1)

# 画图
plt.scatter(x.data.numpy(), y.data.numpy())
plt.show()
</code></pre>
<h2 id="分类">分类</h2>
<p>分类：损失函数一般使用<code>torch.nn.CrossEntropyLoss()</code>:比如类别[0,0,1] 计算出的概率[0.1,0.2,0.7]</p>
<h2 id="快速搭建法">快速搭建法</h2>
<p>主要直接采用<code>torch.nn</code>提供的类来搭建--&gt;对比之前使用<code>import torch.nn.functional as F</code>之后使用一系列函数如<code>relu()</code></p>
<p>使用<code>import torch.nn.functional as F</code>搭建</p>
<pre><code class="language-python">import torch
import torch.nn.functional as F

class Net(torch.nn.Module):
    def __init__(self, n_feature, n_hidden, n_output):
        super(Net, self).__init__()
        self.hidden = torch.nn.Linear(n_feature, n_hidden)
        self.predict = torch.nn,Linear(n_hidden, n_output)
        
    def forward(self, x):
        x = F.relu(self.hidden(x))
        x = self.predict(x)
        return x
</code></pre>
<p>使用<code>torch.nn</code>提供的类搭建</p>
<pre><code class="language-python">import torch

net = torch.nn.Sequential(
	torch.nn.Linear(2,10)
    torch.nn.ReLU()
    torch.nn.Linear(10,2),
)
</code></pre>
<h2 id="保存提取">保存提取</h2>
<p>主要有两种方式：</p>
<ul>
<li>
<p>保存整个网络</p>
<pre><code class="language-python">torch.save(net1, 'net.pkl')
</code></pre>
</li>
<li>
<p>只保存网络中的参数（速度快，占内存少）</p>
<pre><code class="language-python">torch.save(net1.state_dict, 'net_params.pkl')
</code></pre>
</li>
</ul>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#pytorch">pytorch</a></li>
<li><a href="#%E5%AE%89%E8%A3%85">安装</a></li>
<li><a href="#%E5%AF%B9%E6%AF%94numpy%E5%92%8Cpytorch">对比numpy和pytorch</a></li>
<li><a href="#variable%E5%8F%98%E9%87%8F">variable变量</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%BF%80%E5%8A%B1%E5%87%BD%E6%95%B0">为什么需要激励函数？</a></li>
<li><a href="#%E6%BF%80%E5%8A%B1%E5%87%BD%E6%95%B0activation-function">激励函数activation function</a></li>
<li><a href="#%E5%9B%9E%E5%BD%92%E5%85%B3%E7%B3%BB%E6%8B%9F%E5%90%88">回归（关系拟合）</a></li>
<li><a href="#%E5%88%86%E7%B1%BB">分类</a></li>
<li><a href="#%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E6%B3%95">快速搭建法</a></li>
<li><a href="#%E4%BF%9D%E5%AD%98%E6%8F%90%E5%8F%96">保存提取</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://lonely-island.github.io/post/mo-fan-python-xue-xi-bi-ji-1/">
              <h3 class="post-title">
                莫烦python学习笔记1
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://lonely-island.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
